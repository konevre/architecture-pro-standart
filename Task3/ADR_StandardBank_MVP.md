### <a name="_b7urdng99y53"></a>**Название задачи:** 
MVP цифрового открытия депозитов и кредитов (интернет-банк и сайт) в банке «Стандарт»

### <a name="_hjk0fkfyohdk"></a>**Автор:**
Архитектор (Команда цифровой трансформации)

### <a name="_uanumrh8zrui"></a>**Дата:**
22.11.2025

### <a name="_3bfxc9a45514"></a>**Функциональные требования**
Определены верхнеуровневые Use Cases для MVP.

| **№** | **Действующие лица или системы** | **Use Case** | **Описание** |
| :-: | :- | :- | :- |
| UC1 | Новый клиент, Сайт, Система кол-центра | Подача заявки на депозит с сайта | Новый клиент заполняет форму (ФИО, телефон) на сайте. Заявка передается в систему КЦ для обзвона. |
| UC2 | Оператор КЦ, Система КЦ | Обработка заявки с сайта | Оператор связывается с клиентом, консультирует, направляет в отделение для идентификации. |
| UC3 | Клиент ИБ, Интернет-банк | Просмотр персональных ставок | Авторизованный клиент видит список депозитов с расчетом ставок специально для него. |
| UC4 | Клиент ИБ, Интернет-банк, SMS-шлюз | Открытие депозита онлайн | Клиент выбирает параметры депозита, подтверждает открытие СМС-кодом. |
| UC5 | Менеджер бэк-офиса, АБС | Подтверждение депозита (MVP) | Менеджер получает заявку в АБС, проверяет условия и подтверждает открытие счета. |
| UC6 | Клиент, SMS-шлюз | Уведомление об открытии | Клиент получает СМС с подтверждением открытия депозита и ставкой. |
| UC7 | Новый клиент, Сайт, Скоринг | Мгновенная заявка на кредит | Клиент вводит данные паспорта на сайте -> получает предварительное решение (Scoring + БКИ). |
| UC8 | Клиент ИБ, Интернет-банк | Предодобренные кредиты | Клиент видит персональные предложения (Pre-approved), сформированные заранее. |
| UC9 | Клиент ИБ, Интернет-банк | Оформление кредита онлайн | Клиент принимает предложение, выбирает счет зачисления, подтверждает СМС. |

### <a name="_u8xz25hbrgql"></a>**Нефункциональные требования**

| **№** | **Требование** |
| :-: | :- |
| NFR1 | **Доступность:** Интернет-банк и сервисы заявок должны работать 24/7, SLA 99.9%. |
| NFR2 | **Производительность UI:** Отклик интерфейса (справочники, ставки) < 300 мс. |
| NFR3 | **Безопасность:** Шифрование трафика (TLS) для всех каналов; маскирование ПДн. |
| NFR4 | **Надежность АБС:** Недопустимы прямые синхронные запросы из ИБ в БД АБС (защита от перегрузки). |
| NFR5 | **Интеграция:** Использование асинхронного обмена (очереди/адаптеры) там, где это возможно. |
| NFR6 | **Технологии:** Стек .NET/Java, БД Oracle/MS SQL. |
| NFR7 | **Масштабируемость:** Горизонтальное масштабирование новых сервисов (Stateless). |

### <a name="_qmphm5d6rvi3"></a>**Решение**

#### Концептуальная архитектура

Для реализации MVP и снижения нагрузки на Core-системы (АБС) вводится промежуточный слой **Прикладных Сервисов (Application Layer)**.

**Основные компоненты решения:**
1.  **Сервис Заявок (Product Application Service):** Центральный компонент, принимающий заявки из всех каналов (Сайт, ИБ). Он отвязывает фронтенд от бэкенд-систем.
2.  **Сервис Ставок (Rates Service):** Отдельный сервис для хранения и расчета ставок (замена Excel). Используется и онлайн-каналами, и сотрудниками отделений.
3.  **Integration Adapter (ABS Adapter):** Специальный компонент для защиты АБС. Принимает команды от Сервиса Заявок и аккуратно перекладывает их в АБС (через API или очереди), сглаживая пиковые нагрузки.

#### Диаграммы C4

Диаграммы представлены в отдельных файлах в папке решения.

**1. Диаграмма Контекста (Context):** `C4_Context_StandardBank_MVP.puml`
Отображает взаимодействие Клиентов (Новых и Текущих) с Сайтом, ИБ и новыми Сервисами, а также связь с АБС, Кредитным конвейером и внешними системами (БКИ, SMS).

**2. Диаграмма Контейнеров (Containers):** `C4_Containers_StandardBank_MVP.puml`
Детализация архитектуры:
*   **Интернет-банк:** Разделен на Web Frontend (ASP.NET MVC) и Backend (Legacy Monolith). Монолит интегрируется с новыми сервисами по REST.
*   **Новые сервисы:** Java/.NET приложения с собственными БД (MS SQL/Oracle).
*   **АБС:** Показан "Толстый клиент" (Delphi) и БД (Oracle) + новый Интеграционный адаптер.

#### Логика выбора технологий
*   **Микросервисы (Service-based):** Выбраны для новых компонентов (Заявки, Ставки), чтобы не усложнять и так перегруженный монолит АБС и легаси ИБ.
*   **Асинхронность:** Для интеграции с АБС и Кредитным конвейером закладывается асинхронная модель (через БД адаптера или очереди в будущем), чтобы обеспечить требование NFR4.
*   **Стек:** Используются .NET и Java, так как в банке уже есть экспертиза (команды ИБ и АБС/подрядчики).

### <a name="_bjrr7veeh80c"></a>**Альтернативы**

| Альтернатива | Описание | Плюсы | Минусы |
| :--- | :--- | :--- | :--- |
| **Прямая интеграция (ИБ -> АБС)** | ИБ пишет заявки напрямую в таблицы АБС. | Дешево, быстро (на старте). | Риск положить АБС; сложность поддержки; жесткая связность. Отклонено из-за NFR4. |
| **Реализация внутри АБС** | Вся логика ставок и заявок пишется на PL/SQL внутри Oracle. | Данные в одном месте. | АБС масштабируется только вертикально; сложно найти разработчиков Delphi/PL-SQL; медленный Time-to-Market. |
| **Внешнее коробочное решение** | Покупка готового CRM/Front-office решения. | Готовый функционал. | Сложная интеграция с самописной АБС; высокая стоимость лицензий; зависимость от вендора. |

### **Недостатки, ограничения, риски**

1.  **Сложность ландшафта:** Появление новых звеньев (Сервис Заявок, Адаптеры) усложняет инфраструктуру и мониторинг.
2.  **Legacy ИБ:** Старый монолит ИБ может быть узким местом при интеграции с современными REST API новых сервисов.
3.  **Ручной этап в MVP:** Сохранение ручного подтверждения в АБС менеджером бэк-офиса (UC5) снижает скорость обслуживания, но необходимо для быстрого запуска.
4.  **Синхронизация данных:** Риск рассинхрона статусов между АБС, Конвейером и Сервисом Заявок при сбоях сети. Требуется реализация механизмов Retry и сверки (Reconciliation).
